version: '3.8'

services:
  bind9:
    build:
      context: .
    container_name: bind9  # Nom unique du conteneur
    ports:
      - "53:53/udp"        # Port DNS UDP
      - "53:53/tcp"        # Port DNS TCP
      - "2222:22"          # Port SSH pour configuration avec Ansible
    environment:
      TZ: "Europe/Paris"   # Configuration du fuseau horaire
    networks:
      - bind_network       # Ajout au réseau défini ci-dessous
    volumes:
      - ./zones:/var/lib/bind
      - bind9_data:/etc/bind  # Montage des données persistantes
      - type: bind
        source: /home/toine-fa/SAE5.02/test_ansible/roles/bind9/named.conf
        target: /etc/bind/named.conf

volumes:
  bind9_data:
    driver: local           # Volume pour stocker les données persistantes

networks:
  bind_network:
    driver: bridge          # Réseau interne pour les services
